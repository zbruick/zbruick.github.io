
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="width:1000 px">

<div style="float:right; width:98 px; height:98px;">
<img src="https://raw.githubusercontent.com/Unidata/MetPy/master/metpy/plots/_static/unidata_150x150.png" alt="Unidata Logo" style="height: 98px;">
</div><p><h1>Command Line Tool Creation</h1></p>
<h3>Unidata Python Workshop</h3><div style="clear:both"></div>
</div><hr style="height:2px;">

<div style="float:right; width:250 px"><img src="http://media02.hongkiat.com/developers-command-line/command-line.jpg" alt="Command Line" style="height: 500px;"></div><h2 id="Overview:">Overview:<a class="anchor-link" href="#Overview:">&#182;</a></h2><ul>
<li><strong>Teaching:</strong> 30 minutes</li>
<li><strong>Exercises:</strong> 36 minutes</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Create-command-line-tools-to-do-common-jobs">Create command line tools to do common jobs<a class="anchor-link" href="#Create-command-line-tools-to-do-common-jobs">&#182;</a></h1><ul>
<li>Do common data manipulations</li>
<li>Make plots</li>
<li>Download data or batch process items</li>
</ul>
<div style="float:right; width:250 px"><img src="https://unidata.github.io/MetPy/latest/_images/sounding.png" alt="Sounding" style="height: 500px;"></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="You-are-already-used-to-using-command-line-tools">You are already used to using command line tools<a class="anchor-link" href="#You-are-already-used-to-using-command-line-tools">&#182;</a></h1><ul>
<li>ls</li>
<li>grep</li>
<li>git</li>
<li>GEMPAK</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Command-line-tools-take-command-line-arguments">Command line tools take command line arguments<a class="anchor-link" href="#Command-line-tools-take-command-line-arguments">&#182;</a></h1>
<pre><code>GREP(1)                   BSD General Commands Manual                  GREP(1)

NAME
     grep, egrep, fgrep, zgrep, zegrep, zfgrep -- file pattern searcher

SYNOPSIS
     grep [-abcdDEFGHhIiJLlmnOopqRSsUVvwxZ] [-A num] [-B num] [-C[num]] [-e pattern] [-f file] [--binary-files=value] [--color[=when]] [--colour[=when]]
          [--context[=num]] [--label] [--line-buffered] [--null] [pattern] [file ...]

DESCRIPTION
     The grep utility searches any given input files, selecting lines that match one or more patterns.  By default, a pattern matches an input line if the regular
     expression (RE) in the pattern matches the input line without its trailing newline.  An empty expression matches every line.  Each input line that matches at
     least one of the patterns is written to the standard output.

     grep is used for simple patterns and basic regular expressions (BREs); egrep can handle extended regular expressions (EREs).  See re_format(7) for more informa-
     tion on regular expressions.  fgrep is quicker than both grep and egrep, but can only handle fixed patterns (i.e. it does not interpret regular expressions).
     Patterns may consist of one or more lines, allowing any of the pattern lines to match a portion of the input.

     zgrep, zegrep, and zfgrep act like grep, egrep, and fgrep, respectively, but accept input files compressed with the compress(1) or gzip(1) compression utili-
     ties.

     The following options are available:

     -A num, --after-context=num
             Print num lines of trailing context after each match.  See also the -B and -C options.

     -a, --text
             Treat all files as ASCII text.  Normally grep will simply print ``Binary file ... matches'' if files contain binary characters.  Use of this option
             forces grep to output lines matching the specified pattern.

     -B num, --before-context=num
             Print num lines of leading context before each match.  See also the -A and -C options.

     -b, --byte-offset
             The offset in bytes of a matched pattern is displayed in front of the respective matched line.

     -C[num, --context=num]
             Print num lines of leading and trailing context surrounding each match.  The default is 2 and is equivalent to -A 2 -B 2.  Note: no whitespace may be
             given between the option and its argument.</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Start-by-writing-a-&quot;requirements-document&quot;-for-yourself">Start by writing a "requirements document" for yourself<a class="anchor-link" href="#Start-by-writing-a-&quot;requirements-document&quot;-for-yourself">&#182;</a></h1><ul>
<li>Describe the specific functionality of the tool</li>
<li>Describe the options that are available to the user</li>
<li>Include an expected set of outputs</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="You-can-also-begin-the-design-process">You can also begin the design process<a class="anchor-link" href="#You-can-also-begin-the-design-process">&#182;</a></h2><ul>
<li>Functional blocks</li>
<li>Flow charts</li>
<li>Interface decisions</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Let's-design-a-tool-to-make-a-plot-like-this">Let's design a tool to make a plot like this<a class="anchor-link" href="#Let's-design-a-tool-to-make-a-plot-like-this">&#182;</a></h1><p><img src="example_output.png" alt="Example image"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Requirements---Let's-design-the-tool">Requirements - Let's design the tool<a class="anchor-link" href="#Requirements---Let's-design-the-tool">&#182;</a></h1><ul>
<li>Plot super national visible satellite image</li>
<li>Contour a recent GFS field of the user's choice and a level specified by the user</li>
<li>Plot with a basemap containing coastlines, country, state, and provice borders</li>
<li>Make the plot for the current time or up to 24 hours in the past</li>
<li>Use the GFS and satellite data from the time closest to that requested (smallest delta t)</li>
<li>Indicate the model and satellite times on the plot</li>
<li>Show or save the output image</li>
<li>Have a sensible default behavior</li>
<li>Include help documentation to remind others and ourselves how to use the program</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="We'll-use-five-command-line-arguments">We'll use five command line arguments<a class="anchor-link" href="#We'll-use-five-command-line-arguments">&#182;</a></h1><ul>
<li><strong>--gfsfield GFSFIELD</strong>   - <em>CF field name of data to contour from the GFS model.</em></li>
<li><strong>--gfslevel GFSLEVEL</strong>   - <em>Model level to plot (in hPa)</em></li>
<li><strong>--hours HOURS</strong>         - <em>Time to plot (must be present or past)</em></li>
<li><strong>--savefig</strong>             - <em>Save out figure instead of displaying it</em></li>
<li><strong>--imgformat IMGFORMAT</strong> - <em>Format to save the resulting image as.</em></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="We-could-write-a-parser-ourselves,-but-there's-no-need">We could write a parser ourselves, but there's no need<a class="anchor-link" href="#We-could-write-a-parser-ourselves,-but-there's-no-need">&#182;</a></h1><p>The <a href="https://docs.python.org/3/library/argparse.html">argparse</a> module has us covered!
<img src="http://i.imgur.com/KGrV41o.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># For demo purposes only</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">argv</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;greetme.py&#39;</span><span class="p">,</span> <span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;--greeting&#39;</span><span class="p">,</span> <span class="s1">&#39;Hola,&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>

<span class="c1"># Create an instance</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;A simple program that prints a greeting to the name specified&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Add a name argument</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the person being greeted&#39;</span><span class="p">)</span>

<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--greeting&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Hello, &#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Greeting to be used&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Parse the arguments</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Print the greeting</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{args.greeting}</span><span class="s1"> </span><span class="si">{args.name}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Let's-run-it-all-together!">Let's run it all together!<a class="anchor-link" href="#Let's-run-it-all-together!">&#182;</a></h1><ul>
<li>Create using the editor in the notebook</li>
<li>Run from the command line</li>
</ul>

</div>
</div>
</div>
 

